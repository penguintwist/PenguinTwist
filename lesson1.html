<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 1: Hello World - PenguinTwist</title>
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
            transition: all 0.3s ease;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .dark-mode-toggle {
            position: absolute;
            top: 1rem;
            right: 2rem;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .dark-mode-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .nav-back {
            background: white;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .nav-back .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .nav-back a {
            color: #667eea;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .nav-back a:hover {
            text-decoration: underline;
        }
        
        .lesson-content {
            background: white;
            margin: 2rem auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 2rem;
            transition: all 0.3s ease;
        }
        
        .section {
            margin-bottom: 3rem;
        }
        
        .section h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .intro {
            background: #e8f4fd;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #4facfe;
        }
        
        .theory {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        
        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Fira Code', 'Courier New', monospace;
            white-space: pre-line;
            line-height: 1.4;
        }
        
        .expected-output {
            background: #e8f5e8;
            color: #2d5016;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid #28a745;
            font-family: 'Fira Code', 'Courier New', monospace;
        }
        
        .tip {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid #fdcb6e;
        }
        
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid #dc3545;
        }
        
        /* NEW: Visual Metaphor Styles */
        .print-metaphor {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
            border: 2px solid #667eea;
            position: relative;
            overflow: hidden;
        }
        
        .metaphor-title {
            text-align: center;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }
        
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .flow-step {
            flex: 1;
            min-width: 180px;
            text-align: center;
            position: relative;
        }
        
        .flow-box {
            background: white;
            border: 3px solid #667eea;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .flow-box.animated {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2); }
            50% { transform: scale(1.05); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
        }
        
        .flow-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .flow-label {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .flow-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.3;
        }
        
        .flow-arrow {
            font-size: 2rem;
            color: #667eea;
            animation: float 2s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }
        
        .message-box {
            background: #4facfe;
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-weight: bold;
            display: inline-block;
            position: relative;
            animation: messageFloat 3s ease-in-out infinite;
        }
        
        @keyframes messageFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(1deg); }
            75% { transform: translateY(-3px) rotate(-1deg); }
        }
        
        .message-box::before {
            content: "‚úâÔ∏è";
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 1.2rem;
        }
        
        /* Animation Demo Section */
        .animation-demo {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            color: white;
            position: relative;
        }
        
        .demo-controls {
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .demo-btn {
            background: #4facfe;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .demo-btn:hover {
            background: #359ff0;
            transform: translateY(-2px);
        }
        
        .execution-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .step {
            background: #2d3748;
            border-radius: 8px;
            padding: 1rem;
            border-left: 4px solid #4facfe;
            opacity: 0.3;
            transition: all 0.5s ease;
        }
        
        .step.active {
            opacity: 1;
            background: #4a5568;
            transform: scale(1.05);
        }
        
        .step-number {
            background: #4facfe;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .step-title {
            color: #4facfe;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .step-description {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .python-playground {
            background: white;
            border: 2px solid #667eea;
            border-radius: 12px;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);
        }
        
        .playground-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .playground-controls {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-run {
            background: #28a745;
            color: white;
        }
        
        .btn-run:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .btn-reset {
            background: #6c757d;
            color: white;
        }
        
        .btn-reset:hover {
            background: #545b62;
            transform: translateY(-1px);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .editor-container {
            position: relative;
        }
        
        .CodeMirror {
            height: 150px;
            font-size: 14px;
            font-family: 'Fira Code', 'Courier New', monospace;
        }
        
        #challengeArea .CodeMirror {
            height: 200px;
        }
        
        .output-container {
            background: #1a1a1a;
            color: #00ff00;
            padding: 1rem;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
            border-top: 1px solid #333;
            min-height: 60px;
        }
        
        .output-container:empty::before {
            content: "Click 'Run Code' to see your output here...";
            color: #666;
            font-style: italic;
        }
        
        .loading {
            color: #ffc107;
        }
        
        .error {
            color: #ff6b6b;
        }
        
        .success {
            color: #28a745;
        }
        
        .mastery-check {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border-radius: 12px;
            color: white;
        }
        
        .mastery-check h4 {
            margin-bottom: 1rem;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .mastery-question {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .mastery-question input[type="text"] {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-family: 'Fira Code', 'Courier New', monospace;
            margin-top: 0.5rem;
        }
        
        .check-answer-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: block;
            margin: 1rem auto;
        }
        
        .check-answer-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
        }
        
        .feedback.correct {
            background: rgba(40, 167, 69, 0.2);
            border: 2px solid rgba(40, 167, 69, 0.5);
        }
        
        .feedback.incorrect {
            background: rgba(220, 53, 69, 0.2);
            border: 2px solid rgba(220, 53, 69, 0.5);
        }
        
        .practice-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
        }
        
        .practice-section h4 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
            text-align: center;
        }
        
        .practice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        .practice-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .practice-card:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .practice-card h5 {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .practice-card p {
            margin-bottom: 1rem;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .difficulty-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            position: absolute;
            bottom: 1rem;
            right: 1rem;
        }
        
        .difficulty-badge.basic {
            background: rgba(40, 167, 69, 0.8);
            color: white;
        }
        
        .difficulty-badge.creative {
            background: rgba(255, 193, 7, 0.8);
            color: #333;
        }
        
        .difficulty-badge.advanced {
            background: rgba(220, 53, 69, 0.8);
            color: white;
        }
        
        .challenge-area {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }
        
        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .challenge-header h4 {
            color: #667eea;
            margin: 0;
        }
        
        .close-challenge-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .close-challenge-btn:hover {
            background: #c82333;
        }
        
        .challenge-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        .nav-challenge-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .nav-challenge-btn:hover {
            background: #5a6fd8;
        }
        
        .nav-challenge-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        #challengeCounter {
            font-weight: 600;
            color: #667eea;
        }
        
        .lesson-navigation {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 2rem 0;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            display: inline-block;
            font-weight: 600;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .nav-btn.disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Dark Mode Styles */
        body.dark-mode {
            background: #1a1a1a;
            color: #e0e0e0;
        }
        
        body.dark-mode .header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
        }
        
        body.dark-mode .dark-mode-toggle {
            background: rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.3);
            color: #fbbf24;
        }
        
        body.dark-mode .dark-mode-toggle:hover {
            background: rgba(251, 191, 36, 0.3);
        }
        
        body.dark-mode .nav-back {
            background: #2d3748;
        }
        
        body.dark-mode .nav-back a {
            color: #81c784;
        }
        
        body.dark-mode .lesson-content,
        body.dark-mode .lesson-navigation {
            background: #2d3748;
            color: #e0e0e0;
        }
        
        body.dark-mode .intro {
            background: #1e3a3a;
            border-left-color: #4facfe;
        }
        
        body.dark-mode .theory {
            background: #1e2d1e;
            border-left-color: #28a745;
        }
        
        body.dark-mode .tip {
            background: #3d3520;
            border-color: #ffeaa7;
            color: #fff3cd;
        }
        
        body.dark-mode .warning {
            background: #3d2020;
            border-color: #f5c6cb;
            color: #f8d7da;
        }
        
        body.dark-mode .expected-output {
            background: #1e2d1e;
            color: #81c784;
        }
        
        body.dark-mode .section h3 {
            color: #81c784;
            border-bottom-color: #81c784;
        }
        
        body.dark-mode .print-metaphor {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-color: #81c784;
        }
        
        body.dark-mode .metaphor-title {
            color: #81c784;
        }
        
        body.dark-mode .flow-box {
            background: #1a202c;
            border-color: #81c784;
        }
        
        body.dark-mode .flow-label {
            color: #81c784;
        }
        
        body.dark-mode .flow-arrow {
            color: #81c784;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .lesson-content {
                padding: 1rem;
            }
            
            .playground-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .dark-mode-toggle {
                top: 0.5rem;
                right: 1rem;
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .flow-diagram {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
            }
            
            .execution-steps {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button id="darkModeToggle" class="dark-mode-toggle">üåô Dark Mode</button>
        <div class="container">
            <h1>Lesson 1: Hello World</h1>
            <p>Learn how to make the computer display a message</p>
        </div>
    </div>
    
    <div class="nav-back">
        <div class="container">
            <a href="navigation.html">‚Üê Back to All Lessons</a>
        </div>
    </div>
    
    <div class="container">
        <div class="lesson-content">
            <div class="section">
                <h3>Why Programs Need to Communicate</h3>
                <div class="intro">
                    <p>Computers are powerful machines, but they can't speak to us naturally. When you write a program, you need a way to see what the computer is thinking and doing.</p>
                    <p>The <code>print()</code> function is like giving your computer a voice - it displays messages on the screen so you can see what's happening inside your program.</p>
                </div>
            </div>
            
            <div class="section">
                <h3>How Print Works - The Message Delivery System</h3>
                <div class="print-metaphor">
                    <div class="metaphor-title">Think of print() as a Message Delivery Service</div>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="flow-box">
                                <div class="flow-icon">üìù</div>
                                <div class="flow-label">1. You Write</div>
                                <div class="flow-description">You write your message in quotes</div>
                                <div style="margin-top: 0.5rem; font-family: monospace; font-size: 0.8rem; color: #4facfe;">print("Hello!")</div>
                            </div>
                        </div>
                        
                        <div class="flow-arrow">‚Üí</div>
                        
                        <div class="flow-step">
                            <div class="flow-box">
                                <div class="flow-icon">üêç</div>
                                <div class="flow-label">2. Python Reads</div>
                                <div class="flow-description">Python finds your message and prepares to deliver it</div>
                                <div class="message-box">Hello!</div>
                            </div>
                        </div>
                        
                        <div class="flow-arrow">‚Üí</div>
                        
                        <div class="flow-step">
                            <div class="flow-box">
                                <div class="flow-icon">üñ•Ô∏è</div>
                                <div class="flow-label">3. Screen Shows</div>
                                <div class="flow-description">Your message appears on the screen for everyone to see!</div>
                                <div style="background: #1a1a1a; color: #00ff00; padding: 0.5rem; border-radius: 4px; font-family: monospace; margin-top: 0.5rem;">Hello!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>Watch Print() in Action</h3>
                <div class="animation-demo">
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="playExecutionDemo()">‚ñ∂ Watch How Print Works</button>
                    </div>
                    <div class="execution-steps">
                        <div class="step" id="step1">
                            <div class="step-number">1</div>
                            <div class="step-title">Code Written</div>
                            <div class="step-description">You type: print("Hello, World!")</div>
                        </div>
                        <div class="step" id="step2">
                            <div class="step-number">2</div>
                            <div class="step-title">Python Analyzes</div>
                            <div class="step-description">Python reads your code and finds the message "Hello, World!" inside the quotes</div>
                        </div>
                        <div class="step" id="step3">
                            <div class="step-number">3</div>
                            <div class="step-title">Message Extracted</div>
                            <div class="step-description">Python takes the text from between the quotes and prepares to display it</div>
                        </div>
                        <div class="step" id="step4">
                            <div class="step-number">4</div>
                            <div class="step-title">Output Displayed</div>
                            <div class="step-description">The message appears on your screen: Hello, World!</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>The Print Function Rules</h3>
                <div class="theory">
                    <p>In Python, you tell the computer to show a message using this exact pattern:</p>
                    <div class="code-example">print("Hello, World!")</div>
                    
                    <p>When you run this code, the computer displays exactly what's between the quotes:</p>
                    <div class="expected-output"><strong>Output:</strong> Hello, World!</div>
                    
                    <div class="tip">
                        <strong>The Magic of Quotes:</strong> The quotes are like invisible envelopes that wrap around your message. They tell Python "this is text that should be displayed exactly as written." Without quotes, Python gets confused and doesn't know what you want to show.
                    </div>
                    
                    <div class="warning">
                        <strong>Remember:</strong> Every opening quote (") needs a closing quote ("). Think of them as a pair that must stay together to protect your message!
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>Try It Yourself</h3>
                <div class="python-playground">
                    <div class="playground-header">
                        <span>üêç Python Practice Area</span>
                        <div class="playground-controls">
                            <button class="btn btn-run" onclick="runCode()">‚ñ∂ Run Code</button>
                            <button class="btn btn-reset" onclick="resetCode()">üîÑ Reset</button>
                        </div>
                    </div>
                    <div class="editor-container">
                        <textarea id="editor">print("Hello, World!")</textarea>
                    </div>
                    <div class="output-container" id="output"></div>
                </div>
            </div>
            
            <div class="mastery-check">
                <h4>Check Your Understanding</h4>
                <div class="mastery-question">
                    <p><strong>Question:</strong> Write a print statement that displays your name.</p>
                    <input type="text" id="masteryAnswer" placeholder='Type your answer here, like: print("Alex")'>
                </div>
                <button class="check-answer-btn" onclick="checkMastery()">Check Answer</button>
                <div id="masteryFeedback" class="feedback" style="display: none;"></div>
            </div>
            
            <div class="practice-section" id="practiceSection" style="display: none;">
                <h4>Additional Practice</h4>
                <div class="practice-grid">
                    <div class="practice-card" onclick="loadPractice('basic')">
                        <h5>More Practice</h5>
                        <p>Need extra practice with print statements? Try more examples.</p>
                        <div class="difficulty-badge basic">Beginner</div>
                    </div>
                    <div class="practice-card" onclick="loadPractice('creative')">
                        <h5>Creative Challenges</h5>
                        <p>Make your print statements more interesting and personal.</p>
                        <div class="difficulty-badge creative">Creative</div>
                    </div>
                    <div class="practice-card" onclick="loadPractice('advanced')">
                        <h5>Extension Tasks</h5>
                        <p>Ready for something more challenging? Try these advanced tasks.</p>
                        <div class="difficulty-badge advanced">Advanced</div>
                    </div>
                </div>
            </div>
            
            <div class="challenge-area" id="challengeArea" style="display: none;">
                <div class="challenge-header">
                    <h4 id="challengeTitle">Challenge Task</h4>
                    <button class="close-challenge-btn" onclick="closeChallengeArea()">√ó Close</button>
                </div>
                <div id="challengeDescription"></div>
                <div class="python-playground">
                    <div class="playground-header">
                        <span>Challenge Practice Area</span>
                        <div class="playground-controls">
                            <button class="btn btn-run" onclick="runChallengeCode()">‚ñ∂ Run Code</button>
                            <button class="btn btn-reset" onclick="resetChallengeCode()">üîÑ Reset</button>
                        </div>
                    </div>
                    <div class="editor-container">
                        <textarea id="challengeEditor"># Write your code here</textarea>
                    </div>
                    <div class="output-container" id="challengeOutput"></div>
                </div>
                <div class="challenge-navigation">
                    <button class="nav-challenge-btn" onclick="previousChallenge()">‚Üê Previous</button>
                    <span id="challengeCounter">1 of 3</span>
                    <button class="nav-challenge-btn" onclick="nextChallenge()">Next ‚Üí</button>
                </div>
            </div>
        </div>
        
        <div class="lesson-navigation">
            <div class="nav-buttons">
                <a href="#" class="nav-btn disabled">‚Üê Previous Lesson</a>
                <a href="navigation.html" class="nav-btn">üìö All Lessons</a>
                <a href="lesson2.html" class="nav-btn" id="nextLessonBtn">Next Lesson ‚Üí</a>
            </div>
        </div>
    </div>
    
    <!-- CodeMirror JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    
    <script>
        let editor;
        let challengeEditor;
        let masteryCompleted = false;
        const defaultCode = 'print("Hello, World!")';
        
        // Challenge content organized by difficulty
        const challenges = {
            basic: [
                {
                    title: "Practice: Your Information",
                    description: "Write three print statements to show: your name, your age, and your favorite subject.",
                    starter: "# Write three print statements below:\n\n",
                    hint: "Each print statement should look like: print(\"your text here\")"
                },
                {
                    title: "Practice: School Information", 
                    description: "Print your school name, your year group, and your form/tutor group.",
                    starter: "# Print three pieces of school information:\n\n",
                    hint: "Remember the format: print(\"your information\")"
                },
                {
                    title: "Practice: Simple Messages",
                    description: "Print a welcome message, a goodbye message, and a thank you message.",
                    starter: "# Create three different messages:\n\n",
                    hint: "Think about polite things you might say to someone you're meeting."
                }
            ],
            creative: [
                {
                    title: "Creative: Write a Poem",
                    description: "Write a 3-line poem about your favorite animal using three print statements.",
                    starter: "# Line 1 of your poem\nprint(\"First line about your animal\")\n\n# Line 2 of your poem\nprint(\"Second line about your animal\")\n\n# Line 3 of your poem\nprint(\"Third line about your animal\")",
                    hint: "Each line should be in its own print statement. Make it rhyme if you can!"
                },
                {
                    title: "Creative: Design a Menu",
                    description: "Create a simple menu for a restaurant. Print the restaurant name and three menu items.",
                    starter: "# Restaurant name\nprint(\"*** Restaurant Name ***\")\n\n# Menu item 1\nprint(\"1. Menu item here\")\n\n# Menu item 2\nprint(\"2. Menu item here\")\n\n# Menu item 3\nprint(\"3. Menu item here\")",
                    hint: "Be creative with your restaurant name and delicious menu items!"
                },
                {
                    title: "Creative: Story Beginning",
                    description: "Start a short story with three print statements that set the scene.",
                    starter: "# First sentence - introduce the character\nprint(\"Character introduction here\")\n\n# Second sentence - describe the setting\nprint(\"Setting description here\")\n\n# Third sentence - hint at what happens next\nprint(\"What happens next hint here\")",
                    hint: "Think: Who is your character? Where are they? What's about to happen?"
                }
            ],
            advanced: [
                {
                    title: "Advanced: ASCII Art",
                    description: "Use print statements to create simple ASCII art, like a smiley face or your initials.",
                    starter: "# Create ASCII art using print statements\n# Example: \nprint(\"  :-)  \")\nprint(\" /   \\\\ \")\nprint(\"  ---  \")\n\n# Now create your own ASCII art:",
                    hint: "Try making shapes with characters like *, -, |, and spaces."
                },
                {
                    title: "Advanced: Formatted Display",
                    description: "Create a formatted display showing information like a simple ID card or profile.",
                    starter: "# Create a formatted display\nprint(\"===================\")\nprint(\"    STUDENT ID     \")\nprint(\"===================\")\nprint(\"Name: Your Name\")\nprint(\"Year: Your Year\")\nprint(\"Subject: Computer Science\")\nprint(\"===================\")",
                    hint: "Use spaces to align your text nicely. Think about how an ID card might look."
                },
                {
                    title: "Advanced: Multiple Concepts",
                    description: "Print information that demonstrates you understand why print statements are useful in programming.",
                    starter: "# Show multiple ways print can be used\nprint(\"Print statements help programmers:\")\nprint(\"1. Show results to users\")\nprint(\"2. Debug code by showing values\")  \nprint(\"3. Provide feedback and messages\")\nprint(\"4. Display program output\")\n\n# Add your own examples:",
                    hint: "Think about what print statements help programmers do - communicate with users, show results, debug code..."
                }
            ]
        };
        
        let currentChallengeSet = [];
        let currentChallengeIndex = 0;
        
        // Animation demo function
        function playExecutionDemo() {
            const steps = document.querySelectorAll('.step');
            const button = document.querySelector('.demo-btn');
            
            button.disabled = true;
            button.textContent = '‚è≥ Running Demo...';
            
            // Reset all steps
            steps.forEach(step => step.classList.remove('active'));
            
            // Animate each step with delay
            steps.forEach((step, index) => {
                setTimeout(() => {
                    step.classList.add('active');
                    if (index === steps.length - 1) {
                        setTimeout(() => {
                            button.disabled = false;
                            button.textContent = '‚ñ∂ Watch How Print Works';
                            
                            // Keep final step active for a moment, then reset
                            setTimeout(() => {
                                steps.forEach(s => s.classList.remove('active'));
                            }, 2000);
                        }, 500);
                    }
                }, index * 800);
            });
        }
        
        // Initialize CodeMirror editor
        function initializeEditor() {
            const textarea = document.getElementById('editor');
            editor = CodeMirror.fromTextArea(textarea, {
                mode: 'python',
                theme: 'monokai',
                lineNumbers: true,
                indentUnit: 4,
                indentWithTabs: false,
                lineWrapping: true,
                fontSize: '14px'
            });
            editor.setValue(defaultCode);
        }
        
        // Enhanced Python interpreter with more encouraging error messages
        class EducationalPythonInterpreter {
            constructor() {
                this.output = [];
            }
            
            reset() {
                this.output = [];
            }
            
            print(message) {
                this.output.push(String(message));
            }
            
            executeCode(code) {
                this.reset();
                
                const trimmedCode = code.trim();
                if (!trimmedCode) {
                    return 'Ready to run your code! Write a print statement and click Run.';
                }
                
                const lines = trimmedCode.split('\n')
                    .map(line => line.trim())
                    .filter(line => line && !line.startsWith('#'));
                
                try {
                    this.validateSyntax(trimmedCode);
                    
                    for (const line of lines) {
                        // Much simpler check - just look for "print" followed by "(" anywhere in the line
                        if (line.includes('print') && line.includes('(')) {
                            this.handlePrint(line);
                        } else if (line.trim()) {
                            throw new Error(`Python doesn't recognize "${line}" yet. In this lesson, we're focusing on print() statements - try print("your message here")`);
                        }
                    }
                    
                    if (this.output.length === 0) {
                        return 'Your code ran successfully! Add some print statements to see messages appear here.';
                    }
                    
                    return this.output.join('\n');
                } catch (error) {
                    return `üí° Learning moment: ${error.message}`;
                }
            }
            
            validateSyntax(code) {
                const lines = code.split('\n');
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line || line.startsWith('#')) continue;
                    
                    let inQuotes = false;
                    let quoteChar = '';
                    
                    for (let j = 0; j < line.length; j++) {
                        const char = line[j];
                        
                        if ((char === '"' || char === "'") && !inQuotes) {
                            inQuotes = true;
                            quoteChar = char;
                        } else if (char === quoteChar && inQuotes && line[j-1] !== '\\') {
                            inQuotes = false;
                            quoteChar = '';
                        }
                    }
                    
                    if (inQuotes) {
                        throw new Error(`You're missing a closing quote (${quoteChar}) on line ${i + 1}. Remember: every opening quote needs a closing quote to wrap your message properly!`);
                    }
                }
                
                if (code.includes('print') && !code.includes('print(')) {
                    throw new Error('Almost there! You need opening parentheses after print. Try: print("your message")');
                }
                
                const printMatches = code.match(/print\s*\([^)]*$/gm);
                if (printMatches) {
                    throw new Error('You need a closing parenthesis ) to complete your print statement. Try: print("your message")');
                }
                
                if (code.toLowerCase().includes('print') && !code.includes('print')) {
                    if (code.includes('Print')) {
                        throw new Error('Python is case-sensitive - use lowercase "print", not "Print". You\'ve got this!');
                    }
                    if (code.includes('PRINT')) {
                        throw new Error('Python is case-sensitive - use lowercase "print", not "PRINT". Keep going!');
                    }
                }
                
                if (code.includes('prin(') || code.includes('pritn(')) {
                    throw new Error('Check the spelling - it should be "print" (with a t at the end). Almost perfect!');
                }
                
                const printLines = lines.filter(line => line.includes('print'));
                for (const line of printLines) {
                    const match = line.match(/print\s*\((.*)\)/);
                    if (match) {
                        const content = match[1].trim();
                        // Allow quoted strings, numbers, or empty content
                        if (content && !content.startsWith('"') && !content.startsWith("'") && !content.match(/^\d+(\.\d+)?$/)) {
                            throw new Error(`Text needs to be wrapped in quotes so Python knows it's a message. Try: print("${content}")`);
                        }
                    }
                }
            }
            
            handlePrint(line) {
                // Enhanced regex to handle both quoted strings and numbers
                const quotedMatch = line.match(/print\s*\(\s*["'](.*)["']\s*\)/);
                const numberMatch = line.match(/print\s*\(\s*(\d+(?:\.\d+)?)\s*\)/);
                
                if (quotedMatch) {
                    const message = quotedMatch[1];
                    this.print(message);
                } else if (numberMatch) {
                    const number = numberMatch[1];
                    this.print(number);
                } else {
                    throw new Error('Make sure your message is wrapped in quotes like print("Hello") or use a number like print(42)');
                }
            }
        }
        
        // Completely rewritten Python interpreter to avoid caching issues
        class SimplePythonInterpreter {
            constructor() {
                this.results = [];
            }
            
            clear() {
                this.results = [];
            }
            
            addOutput(text) {
                this.results.push(String(text));
            }
            
            run(sourceCode) {
                this.clear();
                
                if (!sourceCode.trim()) {
                    return 'Write some code and click Run to see the output!';
                }
                
                // Split into individual lines and clean them
                const codeLines = sourceCode.split('\n')
                    .map(line => line.trim())
                    .filter(line => line && !line.startsWith('#'));
                
                try {
                    // Very minimal validation - just check quotes
                    this.checkQuotes(sourceCode);
                    
                    // Process each line
                    for (const line of codeLines) {
                        if (this.isPrintStatement(line)) {
                            this.executePrint(line);
                        } else {
                            throw new Error(`Not sure what "${line}" means. Try using print("your message") instead.`);
                        }
                    }
                    
                    return this.results.length > 0 ? this.results.join('\n') : 'Code ran but nothing was printed.';
                    
                } catch (error) {
                    return `üí° ${error.message}`;
                }
            }
            
            isPrintStatement(line) {
                // Simple check: contains both "print" and parentheses
                return line.includes('print') && line.includes('(') && line.includes(')');
            }
            
            executePrint(line) {
                // Extract content between parentheses
                const match = line.match(/print\s*\((.*)\)/);
                if (!match) return;
                
                const content = match[1].trim();
                
                // Handle quoted strings
                if ((content.startsWith('"') && content.endsWith('"')) || 
                    (content.startsWith("'") && content.endsWith("'"))) {
                    this.addOutput(content.slice(1, -1));
                }
                // Handle numbers
                else if (/^\d+(\.\d+)?$/.test(content)) {
                    this.addOutput(content);
                }
                // Handle unquoted text
                else if (content) {
                    throw new Error(`Text "${content}" needs quotes around it. Try print("${content}") instead.`);
                }
            }
            
            checkQuotes(code) {
                let inQuotes = false;
                let quoteChar = '';
                
                for (let i = 0; i < code.length; i++) {
                    const char = code[i];
                    
                    if ((char === '"' || char === "'") && !inQuotes) {
                        inQuotes = true;
                        quoteChar = char;
                    } else if (char === quoteChar && inQuotes) {
                        inQuotes = false;
                        quoteChar = '';
                    }
                }
                
                if (inQuotes) {
                    throw new Error(`Missing closing quote (${quoteChar}). Every opening quote needs a closing quote!`);
                }
            }
        }
        
        const simplePython = new SimplePythonInterpreter();
        
        // Run Python code with new simple interpreter
        async function runCode() {
            const outputElement = document.getElementById('output');
            const runButton = document.querySelector('.btn-run');
            
            try {
                runButton.disabled = true;
                runButton.textContent = "Running...";
                outputElement.innerHTML = '<div class="loading">Running your code...</div>';
                
                const code = editor.getValue();
                
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const result = simplePython.run(code);
                
                if (result.startsWith('üí°')) {
                    outputElement.innerHTML = `<div class="error">${result}</div>`;
                } else {
                    // Ensure proper line breaks in output display
                    const formattedOutput = result.replace(/\n/g, '<br>');
                    outputElement.innerHTML = `<div class="success">${formattedOutput}</div>`;
                }
                
            } catch (error) {
                outputElement.innerHTML = `<div class="error">üí° Unexpected error: ${error.message}</div>`;
            } finally {
                runButton.disabled = false;
                runButton.textContent = "‚ñ∂ Run Code";
            }
        }
        
        function resetCode() {
            editor.setValue(defaultCode);
            document.getElementById('output').innerHTML = '';
        }
        
        // Enhanced mastery check with more encouraging feedback
        function checkMastery() {
            const answer = document.getElementById('masteryAnswer').value.trim();
            const feedbackElement = document.getElementById('masteryFeedback');
            const nextBtn = document.getElementById('nextLessonBtn');
            const practiceSection = document.getElementById('practiceSection');
            
            const printPattern = /^print\s*\(\s*["'][^"']+["']\s*\)$/;
            
            if (printPattern.test(answer)) {
                feedbackElement.innerHTML = "üéâ Perfect! You understand exactly how print() works - you've wrapped your message in quotes and used the right syntax. You're ready to continue learning!";
                feedbackElement.className = "feedback correct";
                masteryCompleted = true;
                
                nextBtn.style.opacity = '1';
                nextBtn.style.pointerEvents = 'auto';
                practiceSection.style.display = 'block';
                
            } else if (answer.toLowerCase().includes('print')) {
                if (!answer.includes('"') && !answer.includes("'")) {
                    feedbackElement.innerHTML = "Great start! You remembered 'print' - now wrap your message in quotes like this: print(\"YourName\")";
                } else if (!answer.includes('(') || !answer.includes(')')) {
                    feedbackElement.innerHTML = "You're getting close! Don't forget the parentheses around your message: print(\"YourName\")";
                } else {
                    feedbackElement.innerHTML = "Almost there! Double-check your syntax - it should look like: print(\"YourName\")";
                }
                feedbackElement.className = "feedback incorrect";
            } else {
                feedbackElement.innerHTML = "Remember, we use print() to display messages. Try typing: print(\"YourName\") - you've got this!";
                feedbackElement.className = "feedback incorrect";
            }
            
            feedbackElement.style.display = 'block';
        }
        
        // Load practice challenges based on difficulty
        function loadPractice(difficulty) {
            currentChallengeSet = challenges[difficulty];
            currentChallengeIndex = 0;
            
            document.getElementById('challengeArea').style.display = 'block';
            document.getElementById('practiceSection').style.display = 'none';
            
            loadCurrentChallenge();
            
            document.getElementById('challengeArea').scrollIntoView({ behavior: 'smooth' });
        }
        
        function loadCurrentChallenge() {
            const challenge = currentChallengeSet[currentChallengeIndex];
            
            document.getElementById('challengeTitle').textContent = challenge.title;
            document.getElementById('challengeDescription').innerHTML = `
                <div style="background: #e8f4fd; padding: 1rem; border-radius: 6px; margin: 1rem 0;">
                    <strong>Task:</strong> ${challenge.description}
                    <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                        <strong>Hint:</strong> ${challenge.hint}
                    </div>
                </div>
            `;
            
            challengeEditor.setValue(challenge.starter);
            setTimeout(() => {
                challengeEditor.refresh();
                challengeEditor.setCursor(challengeEditor.lineCount(), 0);
            }, 100);
            
            document.getElementById('challengeOutput').innerHTML = '';
            
            document.getElementById('challengeCounter').textContent = `${currentChallengeIndex + 1} of ${currentChallengeSet.length}`;
            document.querySelector('.nav-challenge-btn').disabled = currentChallengeIndex === 0;
            document.querySelector('.nav-challenge-btn:last-child').disabled = currentChallengeIndex === currentChallengeSet.length - 1;
        }
        
        function previousChallenge() {
            if (currentChallengeIndex > 0) {
                currentChallengeIndex--;
                loadCurrentChallenge();
            }
        }
        
        function nextChallenge() {
            if (currentChallengeIndex < currentChallengeSet.length - 1) {
                currentChallengeIndex++;
                loadCurrentChallenge();
            }
        }
        
        function closeChallengeArea() {
            document.getElementById('challengeArea').style.display = 'none';
            document.getElementById('practiceSection').style.display = 'block';
        }
        
        async function runChallengeCode() {
            const outputElement = document.getElementById('challengeOutput');
            const runButton = document.querySelector('#challengeArea .btn-run');
            
            try {
                runButton.disabled = true;
                runButton.textContent = "Running...";
                outputElement.innerHTML = '<div class="loading">Running your code...</div>';
                
                const code = challengeEditor.getValue();
                
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const result = simplePython.run(code);
                
                if (result.startsWith('üí°')) {
                    outputElement.innerHTML = `<div class="error">${result}</div>`;
                } else {
                    // Ensure proper line breaks in output display
                    const formattedOutput = result.replace(/\n/g, '<br>');
                    outputElement.innerHTML = `<div class="success">${formattedOutput}</div>`;
                }
                
            } catch (error) {
                outputElement.innerHTML = `<div class="error">üí° Unexpected error: ${error.message}</div>`;
            } finally {
                runButton.disabled = false;
                runButton.textContent = "‚ñ∂ Run Code";
            }
        }
        
        function resetChallengeCode() {
            const challenge = currentChallengeSet[currentChallengeIndex];
            challengeEditor.setValue(challenge.starter);
            setTimeout(() => {
                challengeEditor.refresh();
                challengeEditor.setCursor(challengeEditor.lineCount(), 0);
            }, 100);
            document.getElementById('challengeOutput').innerHTML = '';
        }
        
        // Dark Mode Functionality
        function initializeDarkMode() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const body = document.body;
            
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                body.classList.add('dark-mode');
                darkModeToggle.innerHTML = '‚òÄÔ∏è Light Mode';
            }
            
            darkModeToggle.addEventListener('click', function() {
                body.classList.toggle('dark-mode');
                const isNowDark = body.classList.contains('dark-mode');
                
                darkModeToggle.innerHTML = isNowDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
                localStorage.setItem('darkMode', isNowDark);
                
                if (editor) {
                    editor.setOption('theme', isNowDark ? 'monokai' : 'default');
                }
                if (challengeEditor) {
                    challengeEditor.setOption('theme', isNowDark ? 'monokai' : 'default');
                }
            });
        }
        
        function initializeChallengeEditor() {
            const textarea = document.getElementById('challengeEditor');
            challengeEditor = CodeMirror.fromTextArea(textarea, {
                mode: 'python',
                theme: 'monokai',
                lineNumbers: true,
                indentUnit: 4,
                indentWithTabs: false,
                lineWrapping: true,
                fontSize: '14px',
                viewportMargin: Infinity
            });
            
            setTimeout(() => {
                challengeEditor.refresh();
            }, 100);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeEditor();
            initializeChallengeEditor();
            initializeDarkMode();
            
            const nextBtn = document.getElementById('nextLessonBtn');
            nextBtn.style.opacity = '0.5';
            nextBtn.style.pointerEvents = 'none';
        });
    </script>
</body>
</html>
