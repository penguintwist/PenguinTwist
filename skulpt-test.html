<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Skulpt Loading Test</title>
</head>
<body>
    <h1>Skulpt Loading Test</h1>
    <div id="status">Testing...</div>
    <div id="output"></div>
    
    <script>
        document.getElementById('status').innerHTML = 'Loading Skulpt...';
        
        // Test direct loading
        var script1 = document.createElement('script');
        script1.src = 'https://cdnjs.cloudflare.com/ajax/libs/skulpt/0.11.1/skulpt.min.js';
        script1.onload = function() {
            document.getElementById('status').innerHTML += '<br>✅ Skulpt core loaded';
            
            // Load stdlib
            var script2 = document.createElement('script');
            script2.src = 'https://cdnjs.cloudflare.com/ajax/libs/skulpt/0.11.1/skulpt-stdlib.js';
            script2.onload = function() {
                document.getElementById('status').innerHTML += '<br>✅ Skulpt stdlib loaded';
                testSkulpt();
            };
            script2.onerror = function(e) {
                document.getElementById('status').innerHTML += '<br>❌ Skulpt stdlib failed: ' + e;
            };
            document.head.appendChild(script2);
        };
        script1.onerror = function(e) {
            document.getElementById('status').innerHTML += '<br>❌ Skulpt core failed: ' + e;
            console.error('Skulpt loading error:', e);
        };
        document.head.appendChild(script1);
        
        function testSkulpt() {
            try {
                if (window.Sk) {
                    document.getElementById('status').innerHTML += '<br>✅ Skulpt object exists';
                    
                    // Test basic execution
                    Sk.configure({
                        output: function(text) {
                            document.getElementById('output').innerHTML += text;
                        }
                    });
                    
                    var prog = 'print("Hello from Skulpt!")';
                    var myPromise = Sk.misceval.asyncToPromise(function() {
                        return Sk.importMainWithBody("<stdin>", false, prog, true);
                    });
                    
                    myPromise.then(function() {
                        document.getElementById('status').innerHTML += '<br>✅ Skulpt execution successful!';
                    }).catch(function(err) {
                        document.getElementById('status').innerHTML += '<br>❌ Skulpt execution failed: ' + err;
                    });
                } else {
                    document.getElementById('status').innerHTML += '<br>❌ Skulpt object not found';
                }
            } catch (error) {
                document.getElementById('status').innerHTML += '<br>❌ Skulpt test error: ' + error;
            }
        }
    </script>
</body>
</html>
